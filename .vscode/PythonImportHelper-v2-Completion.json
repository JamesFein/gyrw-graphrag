[
    {
        "label": "pandas",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pandas",
        "description": "pandas",
        "detail": "pandas",
        "documentation": {}
    },
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "json",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "json",
        "description": "json",
        "detail": "json",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "List",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Dict",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "List",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Any",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "Tuple",
        "importPath": "typing",
        "description": "typing",
        "isExtraImport": true,
        "detail": "typing",
        "documentation": {}
    },
    {
        "label": "pyarrow.parquet",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pyarrow.parquet",
        "description": "pyarrow.parquet",
        "detail": "pyarrow.parquet",
        "documentation": {}
    },
    {
        "label": "hashlib",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "hashlib",
        "description": "hashlib",
        "detail": "hashlib",
        "documentation": {}
    },
    {
        "label": "re",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "re",
        "description": "re",
        "detail": "re",
        "documentation": {}
    },
    {
        "label": "Counter",
        "importPath": "collections",
        "description": "collections",
        "isExtraImport": true,
        "detail": "collections",
        "documentation": {}
    },
    {
        "label": "analyze_parquet_file",
        "kind": 2,
        "importPath": "analyze_parquet_structure",
        "description": "analyze_parquet_structure",
        "peekOfCode": "def analyze_parquet_file(file_path: str) -> Dict[str, Any]:\n    \"\"\"\n    åˆ†æå•ä¸ªparquetæ–‡ä»¶çš„ç»“æ„\n    Args:\n        file_path: parquetæ–‡ä»¶è·¯å¾„\n    Returns:\n        åŒ…å«æ–‡ä»¶åˆ†æç»“æœçš„å­—å…¸\n    \"\"\"\n    try:\n        # è¯»å–parquetæ–‡ä»¶",
        "detail": "analyze_parquet_structure",
        "documentation": {}
    },
    {
        "label": "find_parquet_files",
        "kind": 2,
        "importPath": "analyze_parquet_structure",
        "description": "analyze_parquet_structure",
        "peekOfCode": "def find_parquet_files(directory: str) -> List[str]:\n    \"\"\"\n    åœ¨æŒ‡å®šç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰parquetæ–‡ä»¶\n    Args:\n        directory: æœç´¢ç›®å½•\n    Returns:\n        parquetæ–‡ä»¶è·¯å¾„åˆ—è¡¨\n    \"\"\"\n    parquet_files = []\n    for root, dirs, files in os.walk(directory):",
        "detail": "analyze_parquet_structure",
        "documentation": {}
    },
    {
        "label": "generate_analysis_report",
        "kind": 2,
        "importPath": "analyze_parquet_structure",
        "description": "analyze_parquet_structure",
        "peekOfCode": "def generate_analysis_report(analysis_results: List[Dict[str, Any]]) -> str:\n    \"\"\"\n    ç”Ÿæˆåˆ†ææŠ¥å‘Š\n    Args:\n        analysis_results: åˆ†æç»“æœåˆ—è¡¨\n    Returns:\n        æ ¼å¼åŒ–çš„åˆ†ææŠ¥å‘Šå­—ç¬¦ä¸²\n    \"\"\"\n    report = []\n    report.append(\"=\" * 80)",
        "detail": "analyze_parquet_structure",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "analyze_parquet_structure",
        "description": "analyze_parquet_structure",
        "peekOfCode": "def main():\n    \"\"\"ä¸»å‡½æ•°\"\"\"\n    print(\"ğŸ” å¼€å§‹åˆ†æGraphRAG Parquetæ–‡ä»¶ç»“æ„...\")\n    # æŸ¥æ‰¾outputç›®å½•ä¸­çš„æ‰€æœ‰parquetæ–‡ä»¶\n    output_dir = \"output\"\n    if not os.path.exists(output_dir):\n        print(f\"âŒ é”™è¯¯: æ‰¾ä¸åˆ°è¾“å‡ºç›®å½• '{output_dir}'\")\n        return\n    parquet_files = find_parquet_files(output_dir)\n    if not parquet_files:",
        "detail": "analyze_parquet_structure",
        "documentation": {}
    },
    {
        "label": "analyze_relationships",
        "kind": 2,
        "importPath": "check_relationship_types",
        "description": "check_relationship_types",
        "peekOfCode": "def analyze_relationships():\n    \"\"\"åˆ†æå…³ç³»æ•°æ®ä¸­çš„å…³ç³»ç±»å‹\"\"\"\n    # è¯»å–å…³ç³»æ•°æ®\n    df = pd.read_parquet('output/relationships.parquet')\n    print(\"ğŸ” åˆ†æå…³ç³»ç±»å‹ä¿¡æ¯\")\n    print(\"=\" * 50)\n    # æ£€æŸ¥æè¿°å­—æ®µä¸­çš„å…³ç³»ç±»å‹\n    print(\"\\nğŸ“‹ å…³ç³»æè¿°åˆ†æ:\")\n    print(f\"æ€»å…³ç³»æ•°: {len(df)}\")\n    # æŸ¥çœ‹æ‰€æœ‰æè¿°",
        "detail": "check_relationship_types",
        "documentation": {}
    },
    {
        "label": "load_parquet_data",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def load_parquet_data() -> Tuple[pd.DataFrame, pd.DataFrame, pd.DataFrame]:\n    \"\"\"\n    åŠ è½½GraphRAGç”Ÿæˆçš„parquetæ–‡ä»¶\n    Returns:\n        entities, relationships, communitiesæ•°æ®æ¡†\n    \"\"\"\n    try:\n        entities_df = pd.read_parquet(\"output/entities.parquet\")\n        relationships_df = pd.read_parquet(\"output/relationships_with_types.parquet\")\n        communities_df = pd.read_parquet(\"output/communities.parquet\")",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "get_node_color_by_type",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def get_node_color_by_type(entity_type: str) -> Dict[str, str]:\n    \"\"\"\n    æ ¹æ®å®ä½“ç±»å‹è¿”å›èŠ‚ç‚¹é¢œè‰²é…ç½®\n    Args:\n        entity_type: å®ä½“ç±»å‹\n    Returns:\n        é¢œè‰²é…ç½®å­—å…¸\n    \"\"\"\n    color_map = {\n        \"person\": {",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "get_edge_style_by_type",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def get_edge_style_by_type(relationship_type: str) -> Dict[str, Any]:\n    \"\"\"\n    æ ¹æ®å…³ç³»ç±»å‹è¿”å›è¾¹æ ·å¼é…ç½®\n    Args:\n        relationship_type: å…³ç³»ç±»å‹\n    Returns:\n        è¾¹æ ·å¼é…ç½®å­—å…¸\n    \"\"\"\n    style_map = {\n        \"IS_A\": {",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "calculate_edge_width",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def calculate_edge_width(weight: float) -> int:\n    \"\"\"\n    æ ¹æ®å…³ç³»æƒé‡è®¡ç®—è¾¹å®½åº¦\n    Args:\n        weight: å…³ç³»æƒé‡\n    Returns:\n        è¾¹å®½åº¦\n    \"\"\"\n    if pd.isna(weight):\n        return 1",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "entity_to_node",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def entity_to_node(entity_row: pd.Series) -> Dict[str, Any]:\n    \"\"\"\n    å°†å®ä½“æ•°æ®è½¬æ¢ä¸ºvis-networkèŠ‚ç‚¹æ ¼å¼\n    Args:\n        entity_row: å®ä½“æ•°æ®è¡Œ\n    Returns:\n        vis-networkèŠ‚ç‚¹å­—å…¸\n    \"\"\"\n    entity_title = str(entity_row[\"title\"])\n    entity_desc = str(entity_row.get(\"description\", \"\"))",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "relationship_to_edge",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def relationship_to_edge(rel_row: pd.Series, edge_id: str) -> Dict[str, Any]:\n    \"\"\"\n    å°†å…³ç³»æ•°æ®è½¬æ¢ä¸ºvis-networkè¾¹æ ¼å¼\n    Args:\n        rel_row: å…³ç³»æ•°æ®è¡Œ\n        edge_id: è¾¹ID\n    Returns:\n        vis-networkè¾¹å­—å…¸\n    \"\"\"\n    source = str(rel_row[\"source\"])",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "convert_data_to_visnetwork",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def convert_data_to_visnetwork(entities_df: pd.DataFrame, \n                              relationships_df: pd.DataFrame) -> Tuple[List[Dict], List[Dict]]:\n    \"\"\"\n    å°†GraphRAGæ•°æ®è½¬æ¢ä¸ºvis-networkæ ¼å¼\n    Args:\n        entities_df: å®ä½“æ•°æ®æ¡†\n        relationships_df: å…³ç³»æ•°æ®æ¡†\n    Returns:\n        (nodes, edges)å…ƒç»„\n    \"\"\"",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "save_json_data",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def save_json_data(nodes: List[Dict], edges: List[Dict]) -> None:\n    \"\"\"\n    ä¿å­˜æ•°æ®ä¸ºJSONæ–‡ä»¶\n    Args:\n        nodes: èŠ‚ç‚¹åˆ—è¡¨\n        edges: è¾¹åˆ—è¡¨\n    \"\"\"\n    # ä¿å­˜èŠ‚ç‚¹æ•°æ®\n    with open(\"nodes.json\", \"w\", encoding=\"utf-8\") as f:\n        json.dump(nodes, f, ensure_ascii=False, indent=2)",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "generate_statistics",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def generate_statistics(nodes: List[Dict], edges: List[Dict]) -> None:\n    \"\"\"\n    ç”Ÿæˆæ•°æ®ç»Ÿè®¡ä¿¡æ¯\n    Args:\n        nodes: èŠ‚ç‚¹åˆ—è¡¨\n        edges: è¾¹åˆ—è¡¨\n    \"\"\"\n    print(\"\\nğŸ“Š æ•°æ®ç»Ÿè®¡:\")\n    print(\"-\" * 40)\n    # èŠ‚ç‚¹ç»Ÿè®¡",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "convert_to_visnetwork",
        "description": "convert_to_visnetwork",
        "peekOfCode": "def main():\n    \"\"\"ä¸»å‡½æ•°\"\"\"\n    print(\"ğŸš€ å¼€å§‹GraphRAGåˆ°vis-networkæ•°æ®è½¬æ¢...\")\n    try:\n        # åŠ è½½æ•°æ®\n        entities_df, relationships_df, communities_df = load_parquet_data()\n        # è½¬æ¢æ•°æ®\n        nodes, edges = convert_data_to_visnetwork(entities_df, relationships_df)\n        # ä¿å­˜æ•°æ®\n        save_json_data(nodes, edges)",
        "detail": "convert_to_visnetwork",
        "documentation": {}
    },
    {
        "label": "extract_relationship_type",
        "kind": 2,
        "importPath": "data_quality_report",
        "description": "data_quality_report",
        "peekOfCode": "def extract_relationship_type(description):\n    \"\"\"ä»æè¿°ä¸­æå–å…³ç³»ç±»å‹\"\"\"\n    # é¢„å®šä¹‰çš„å…³ç³»ç±»å‹åˆ—è¡¨\n    relation_types = [\n        'BELONGS_TO', 'IS_A', 'RELATED_TO', 'TEACHES', 'PREREQUISITE_OF',\n        'PART_OF', 'CAUSES', 'LOCATED_IN', 'MENTIONED_IN', 'WORKS_FOR',\n        'MANAGES', 'CONTAINS', 'OCCURS_BEFORE', 'LEADS_TO', 'COLLABORATES_WITH',\n        'OPPOSES', 'SIMILAR_TO', 'MENTIONS', 'CITES', 'AUTHORED_BY', 'PUBLISHED_IN',\n        'DERIVED_FROM', 'HAS_TOPIC', 'USES', 'EXTENDS', 'HAS_PROPERTY'\n    ]",
        "detail": "data_quality_report",
        "documentation": {}
    },
    {
        "label": "generate_quality_report",
        "kind": 2,
        "importPath": "data_quality_report",
        "description": "data_quality_report",
        "peekOfCode": "def generate_quality_report():\n    \"\"\"ç”Ÿæˆæ•°æ®è´¨é‡æŠ¥å‘Š\"\"\"\n    # è¯»å–æ•°æ®\n    df = pd.read_parquet('output/relationships.parquet')\n    print(\"ğŸ“Š GraphRAGå…³ç³»ç±»å‹æ•°æ®è´¨é‡æŠ¥å‘Š\")\n    print(\"=\" * 60)\n    # åŸºæœ¬ç»Ÿè®¡\n    print(f\"\\nğŸ“ˆ åŸºæœ¬ç»Ÿè®¡:\")\n    print(f\"  æ€»å…³ç³»æ•°: {len(df)}\")\n    print(f\"  å”¯ä¸€æºèŠ‚ç‚¹: {df['source'].nunique()}\")",
        "detail": "data_quality_report",
        "documentation": {}
    },
    {
        "label": "verify_relationship_fields",
        "kind": 2,
        "importPath": "verify_relationship_fields",
        "description": "verify_relationship_fields",
        "peekOfCode": "def verify_relationship_fields():\n    \"\"\"éªŒè¯ relationships.parquet ä¸­çš„å­—æ®µç»“æ„\"\"\"\n    print(\"ğŸ” éªŒè¯ GraphRAG relationships.parquet æ–‡ä»¶ç»“æ„\")\n    print(\"=\" * 60)\n    # è¯»å– relationships.parquet\n    relationships_df = pd.read_parquet('output/relationships.parquet')\n    print(f\"ğŸ“Š Relationships.parquet æ–‡ä»¶ä¿¡æ¯:\")\n    print(f\"  æ–‡ä»¶è·¯å¾„: output/relationships.parquet\")\n    print(f\"  è¡Œæ•°: {len(relationships_df)}\")\n    print(f\"  åˆ—æ•°: {len(relationships_df.columns)}\")",
        "detail": "verify_relationship_fields",
        "documentation": {}
    },
    {
        "label": "compare_with_entities",
        "kind": 2,
        "importPath": "verify_relationship_fields",
        "description": "verify_relationship_fields",
        "peekOfCode": "def compare_with_entities():\n    \"\"\"æ¯”è¾ƒ relationships.parquet å’Œ entities.parquet çš„ä¸€è‡´æ€§\"\"\"\n    print(f\"\\nğŸ”„ æ¯”è¾ƒå®ä½“å’Œå…³ç³»æ•°æ®çš„ä¸€è‡´æ€§:\")\n    entities_df = pd.read_parquet('output/entities.parquet')\n    relationships_df = pd.read_parquet('output/relationships.parquet')\n    # ä»å®ä½“æ–‡ä»¶è·å–æ‰€æœ‰å®ä½“\n    entity_names = set(entities_df['title'].unique())\n    # ä»å…³ç³»æ–‡ä»¶è·å–æ‰€æœ‰èŠ‚ç‚¹\n    if 'source' in relationships_df.columns and 'target' in relationships_df.columns:\n        relationship_nodes = set(relationships_df['source'].unique()) | set(relationships_df['target'].unique())",
        "detail": "verify_relationship_fields",
        "documentation": {}
    }
]